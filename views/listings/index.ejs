<% layout("/layouts/boilerplate.ejs") %>
<style>
    #filters{
        display: flex;
        flex-wrap: wrap;   
    }
    .atag{
        text-decoration: none;    
    }
    .filter{
        text-align: center;
        margin-right: 2rem;
        opacity: 0.7;
        color: #212529;
    }
    .filter p{
        font-size: small;
    }

    .filter:hover {
        opacity: 1.3;
        cursor: pointer;

    }
    .gst{
        display: none;
    }
    
    #tax-toggle{
       border: 1px solid black;
       border-radius: 10px;
       height: 3.0rem;
       padding: 10px;
       margin-left: 9rem;
       /* position: relative;
       top: -5px; */
    }
</style>

<div id="filters" class="mt-3 mb-3"> 
    <a href="/listings/category/arctic" class="atag">
        <div class="filter ">       
            <div><i class="fa-solid fa-snowflake "></i></div>
            <p>Arctic</p>        
        </div> 
    </a>
    <a href="/listings/category/snug spaces" class="atag">
        <div class="filter ">
            <div><i class="fa-solid fa-bed"></i></div>
            <p>Snug spaces</p>
        </div>
    </a>
    <a href="/listings/category/iconic cities" class="atag">
        <div class="filter ">
            <div><i class="fa-solid fa-city"></i></div>
            <p>Iconic cities</p>
        </div>
    </a>
    <a href="/listings/category/mountains" class="atag">
        <div class="filter ">
            <div><i class="fa-solid fa-mountain-sun"></i></i></div>
            <p>Mountains</p>
        </div>
    </a>
    <a href="/listings/category/castle" class="atag ms-2">
        <div class="filter ">
            <div><i class="fa-brands fa-fort-awesome"></i></div>
            <p>Castle</p>
        </div>
    </a>
    <a href="/listings/category/amazing pools" class="atag">
        <div class="filter ">
            <div><i class="fa-solid fa-person-swimming"></i></div>
            <p>Amazing pools</p>
        </div>
    </a>
    <a href="/listings/category/camping" class="atag">
        <div class="filter ">
            <div><i class="fa-solid fa-campground"></i></div>
            <p>Camping</p>
        </div>
    </a>
    <a href="/listings/category/dome" class="atag ms-2">
        <div class="filter ">
            <div><i class="fa-solid fa-igloo"></i></div>
            <p>Dome</p>
        </div>
    </a>
    <a href="/listings/category/coastal charm" class="atag">
        <div class="filter ">
            <div><i class="fa-solid fa-umbrella-beach"></i></div>
            <p>Coastal charm</p>
        </div>
    </a>
    <a href="/listings/category/farms area" class="atag">
        <div class="filter ">
            <div><i class="fa-solid fa-tractor"></i></div>
            <p>Farms area</p>
        </div>
    </a>
    <a href="/listings/category/boats" class="atag ms-3">
        <div class="filter">
            <div><i class="fa-solid fa-ship"></i></div>
            <p>Boats</p>
        </div>
    </a>  
    <div id="tax-toggle">
        <div class="form-check-reverse form-switch ">
            <input class="form-check-input" type="checkbox" role="switch" id="switchCheckDefault">
            <label class="form-check-label" for="">Display taxes</label>
        </div>
    </div>    
</div>

<div>
    <% if(typeof category != "undefined") {%>
        <h4><i><u><%= category %></u></i></h4>
    <% } %>
</div>

<div class="row cardss">
    <% for(let list of allListings) { %>
        <div class="list-cards card col-lg-3 col-md-4 " >
            <a href="/listings/<%= list.id %>" class="listing-links">
                <img src="<%= list.image.url %>" class="card-img-top " alt="image">
                <div class="card-img-overlay overlay-content" >
                    <form class="form-heart" method="get" action="/listings/<%= list.id %>/fav">
                        <button class="btn btn-heart">
                            <% if(typeof user != "undefined") {%>
                                <% if(list.favlisting.some(id=> id.toString() === user._id.toString())) {%>
                                    <i class="fa-solid fa-heart heart" style="color: red;"></i>
                                <% }  else {%>
                                    <i class="fa-solid fa-heart heart"></i>
                                <% } %>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                            <% } else  {%>
                                <i class="fa-solid fa-heart heart"></i>
                            <% } %>
                            
                        </button>
                    </form>
                </div>
                <div class="card-body">
                    <p class="card-text mt-2 mb-0">
                        <b><%= list.title %></b><br>
                        <p class="pricing">&#8377;<%= list.price.toLocaleString("en-IN") %> /night   <i class="gst">+18%GST</i></p>
                    </p>
                </div>
            </a>
        </div>    
    <% }  %>   
</div>    




<script>
    let toggleSwitch = document.querySelector("#tax-toggle");
    
    toggleSwitch.addEventListener("click" ,()=>{
        let gsts = document.querySelectorAll(".gst") 
        for(let gst of gsts){
            if(gst.style.display !== "inline"){
                gst.style.display = "inline";
            }else{
                gst.style.display = "none";
            }
        }
    })    
</script>
